<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Database.MongoDB.Query</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Database-MongoDB-Query.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Database.MongoDB.Query.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">mongoDB-2.3.0: Driver (client) for MongoDB, a free, scalable, fast, document
DBMS</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Database.MongoDB.Query</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Monad</a></li><li><a href="#g:2">Database</a><ul><li><a href="#g:3">Authentication</a></li></ul></li><li><a href="#g:4">Collection</a><ul><li><a href="#g:5">Selection</a></li></ul></li><li><a href="#g:6">Write</a><ul><li><a href="#g:7">Insert</a></li><li><a href="#g:8">Update</a></li><li><a href="#g:9">Delete</a></li></ul></li><li><a href="#g:10">Read</a><ul><li><a href="#g:11">Query</a><ul><li><a href="#g:12">Cursor</a></li></ul></li><li><a href="#g:13">Aggregate</a></li><li><a href="#g:14">Group</a></li><li><a href="#g:15">MapReduce</a></li></ul></li><li><a href="#g:16">Command</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Query and update documents</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">type</span> <a href="#t:Action">Action</a> = <a href="../mtl-2.2.1/Control-Monad-Reader.html#t:ReaderT">ReaderT</a> <a href="Database-MongoDB-Query.html#t:MongoContext">MongoContext</a></li><li class="src short"><a href="#v:access">access</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Connection.html#t:Pipe">Pipe</a> -&gt; <a href="Database-MongoDB-Query.html#t:AccessMode">AccessMode</a> -&gt; <a href="Database-MongoDB-Query.html#t:Database">Database</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m a -&gt; m a</li><li class="src short"><span class="keyword">data</span> <a href="#t:Failure">Failure</a><ul class="subs"><li>= <a href="#v:ConnectionFailure">ConnectionFailure</a> <a href="../base-4.9.1.0/System-IO-Error.html#t:IOError">IOError</a></li><li>| <a href="#v:CursorNotFoundFailure">CursorNotFoundFailure</a> CursorId</li><li>| <a href="#v:QueryFailure">QueryFailure</a> <a href="Database-MongoDB-Query.html#t:ErrorCode">ErrorCode</a> <a href="../base-4.9.1.0/Data-String.html#t:String">String</a></li><li>| <a href="#v:WriteFailure">WriteFailure</a> <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> <a href="Database-MongoDB-Query.html#t:ErrorCode">ErrorCode</a> <a href="../base-4.9.1.0/Data-String.html#t:String">String</a></li><li>| <a href="#v:WriteConcernFailure">WriteConcernFailure</a> <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> <a href="../base-4.9.1.0/Data-String.html#t:String">String</a></li><li>| <a href="#v:DocNotFound">DocNotFound</a> <a href="Database-MongoDB-Query.html#t:Selection">Selection</a></li><li>| <a href="#v:AggregateFailure">AggregateFailure</a> <a href="../base-4.9.1.0/Data-String.html#t:String">String</a></li><li>| <a href="#v:CompoundFailure">CompoundFailure</a> [<a href="Database-MongoDB-Query.html#t:Failure">Failure</a>]</li><li>| <a href="#v:ProtocolFailure">ProtocolFailure</a> <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> <a href="../base-4.9.1.0/Data-String.html#t:String">String</a></li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:ErrorCode">ErrorCode</a> = <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:AccessMode">AccessMode</a><ul class="subs"><li>= <a href="#v:ReadStaleOk">ReadStaleOk</a></li><li>| <a href="#v:UnconfirmedWrites">UnconfirmedWrites</a></li><li>| <a href="#v:ConfirmWrites">ConfirmWrites</a> <a href="Database-MongoDB-Query.html#t:GetLastError">GetLastError</a></li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:GetLastError">GetLastError</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a></li><li class="src short"><a href="#v:master">master</a> :: <a href="Database-MongoDB-Query.html#t:AccessMode">AccessMode</a></li><li class="src short"><a href="#v:slaveOk">slaveOk</a> :: <a href="Database-MongoDB-Query.html#t:AccessMode">AccessMode</a></li><li class="src short"><a href="#v:accessMode">accessMode</a> :: <a href="../base-4.9.1.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Database-MongoDB-Query.html#t:AccessMode">AccessMode</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m a -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m a</li><li class="src short"><a href="#v:liftDB">liftDB</a> :: (<a href="../mtl-2.2.1/Control-Monad-Reader-Class.html#t:MonadReader">MonadReader</a> env m, <a href="Database-MongoDB-Query.html#t:HasMongoContext">HasMongoContext</a> env, <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m) =&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> <a href="../base-4.9.1.0/System-IO.html#t:IO">IO</a> a -&gt; m a</li><li class="src short"><span class="keyword">data</span> <a href="#t:MongoContext">MongoContext</a> = <a href="#v:MongoContext">MongoContext</a> {<ul class="subs"><li><a href="#v:mongoPipe">mongoPipe</a> :: <a href="Database-MongoDB-Connection.html#t:Pipe">Pipe</a></li><li><a href="#v:mongoAccessMode">mongoAccessMode</a> :: <a href="Database-MongoDB-Query.html#t:AccessMode">AccessMode</a></li><li><a href="#v:mongoDatabase">mongoDatabase</a> :: <a href="Database-MongoDB-Query.html#t:Database">Database</a></li></ul>}</li><li class="src short"><span class="keyword">class</span> <a href="#t:HasMongoContext">HasMongoContext</a> env <span class="keyword">where</span><ul class="subs"></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:Database">Database</a> = <a href="../text-1.2.2.2/Data-Text.html#t:Text">Text</a></li><li class="src short"><a href="#v:allDatabases">allDatabases</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="Database-MongoDB-Query.html#t:Database">Database</a>]</li><li class="src short"><a href="#v:useDb">useDb</a> :: <a href="../base-4.9.1.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Database">Database</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m a -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m a</li><li class="src short"><a href="#v:thisDatabase">thisDatabase</a> :: <a href="../base-4.9.1.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="Database-MongoDB-Query.html#t:Database">Database</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:Username">Username</a> = <a href="../text-1.2.2.2/Data-Text.html#t:Text">Text</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:Password">Password</a> = <a href="../text-1.2.2.2/Data-Text.html#t:Text">Text</a></li><li class="src short"><a href="#v:auth">auth</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Username">Username</a> -&gt; <a href="Database-MongoDB-Query.html#t:Password">Password</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:authMongoCR">authMongoCR</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Username">Username</a> -&gt; <a href="Database-MongoDB-Query.html#t:Password">Password</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:authSCRAMSHA1">authSCRAMSHA1</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Username">Username</a> -&gt; <a href="Database-MongoDB-Query.html#t:Password">Password</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:Collection">Collection</a> = <a href="../text-1.2.2.2/Data-Text.html#t:Text">Text</a></li><li class="src short"><a href="#v:allCollections">allCollections</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="Database-MongoDB-Query.html#t:Collection">Collection</a>]</li><li class="src short"><span class="keyword">data</span> <a href="#t:Selection">Selection</a> = <a href="#v:Select">Select</a> {<ul class="subs"><li><a href="#v:selector">selector</a> :: <a href="Database-MongoDB-Query.html#t:Selector">Selector</a></li><li><a href="#v:coll">coll</a> :: <a href="Database-MongoDB-Query.html#t:Collection">Collection</a></li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:Selector">Selector</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a></li><li class="src short"><a href="#v:whereJS">whereJS</a> :: <a href="Database-MongoDB-Query.html#t:Selector">Selector</a> -&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Javascript">Javascript</a> -&gt; <a href="Database-MongoDB-Query.html#t:Selector">Selector</a></li><li class="src short"><span class="keyword">class</span> <a href="#t:Select">Select</a> aQueryOrSelection <span class="keyword">where</span><ul class="subs"></ul></li><li class="src short"><a href="#v:insert">insert</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../bson-0.3.2.3/Data-Bson.html#t:Value">Value</a></li><li class="src short"><a href="#v:insert_">insert_</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m ()</li><li class="src short"><a href="#v:insertMany">insertMany</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>] -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="../bson-0.3.2.3/Data-Bson.html#t:Value">Value</a>]</li><li class="src short"><a href="#v:insertMany_">insertMany_</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>] -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m ()</li><li class="src short"><a href="#v:insertAll">insertAll</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>] -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="../bson-0.3.2.3/Data-Bson.html#t:Value">Value</a>]</li><li class="src short"><a href="#v:insertAll_">insertAll_</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>] -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m ()</li><li class="src short"><a href="#v:save">save</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m ()</li><li class="src short"><a href="#v:replace">replace</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m ()</li><li class="src short"><a href="#v:repsert">repsert</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m ()</li><li class="src short"><a href="#v:upsert">upsert</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m ()</li><li class="src short"><span class="keyword">type</span> <a href="#t:Modifier">Modifier</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a></li><li class="src short"><a href="#v:modify">modify</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="Database-MongoDB-Query.html#t:Modifier">Modifier</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m ()</li><li class="src short"><a href="#v:updateMany">updateMany</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; [(<a href="Database-MongoDB-Query.html#t:Selector">Selector</a>, <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>, [<a href="Database-MongoDB-Query.html#t:UpdateOption">UpdateOption</a>])] -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="Database-MongoDB-Query.html#t:WriteResult">WriteResult</a></li><li class="src short"><a href="#v:updateAll">updateAll</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; [(<a href="Database-MongoDB-Query.html#t:Selector">Selector</a>, <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>, [<a href="Database-MongoDB-Query.html#t:UpdateOption">UpdateOption</a>])] -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="Database-MongoDB-Query.html#t:WriteResult">WriteResult</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:WriteResult">WriteResult</a> = <a href="#v:WriteResult">WriteResult</a> {<ul class="subs"><li><a href="#v:failed">failed</a> :: <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></li><li><a href="#v:nMatched">nMatched</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></li><li><a href="#v:nModified">nModified</a> :: <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></li><li><a href="#v:nRemoved">nRemoved</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></li><li><a href="#v:upserted">upserted</a> :: [<a href="Database-MongoDB-Query.html#t:Upserted">Upserted</a>]</li><li><a href="#v:writeErrors">writeErrors</a> :: [<a href="Database-MongoDB-Query.html#t:Failure">Failure</a>]</li><li><a href="#v:writeConcernErrors">writeConcernErrors</a> :: [<a href="Database-MongoDB-Query.html#t:Failure">Failure</a>]</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:UpdateOption">UpdateOption</a><ul class="subs"><li>= <a href="#v:Upsert">Upsert</a></li><li>| <a href="#v:MultiUpdate">MultiUpdate</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Upserted">Upserted</a> = <a href="#v:Upserted">Upserted</a> {<ul class="subs"><li><a href="#v:upsertedIndex">upsertedIndex</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></li><li><a href="#v:upsertedId">upsertedId</a> :: <a href="../bson-0.3.2.3/Data-Bson.html#t:ObjectId">ObjectId</a></li></ul>}</li><li class="src short"><a href="#v:delete">delete</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m ()</li><li class="src short"><a href="#v:deleteOne">deleteOne</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m ()</li><li class="src short"><a href="#v:deleteMany">deleteMany</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; [(<a href="Database-MongoDB-Query.html#t:Selector">Selector</a>, [<a href="Database-MongoDB-Query.html#t:DeleteOption">DeleteOption</a>])] -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="Database-MongoDB-Query.html#t:WriteResult">WriteResult</a></li><li class="src short"><a href="#v:deleteAll">deleteAll</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; [(<a href="Database-MongoDB-Query.html#t:Selector">Selector</a>, [<a href="Database-MongoDB-Query.html#t:DeleteOption">DeleteOption</a>])] -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="Database-MongoDB-Query.html#t:WriteResult">WriteResult</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:DeleteOption">DeleteOption</a> = <a href="#v:SingleRemove">SingleRemove</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:Query">Query</a> = <a href="#v:Query">Query</a> {<ul class="subs"><li><a href="#v:options">options</a> :: [<a href="Database-MongoDB-Query.html#t:QueryOption">QueryOption</a>]</li><li><a href="#v:selection">selection</a> :: <a href="Database-MongoDB-Query.html#t:Selection">Selection</a></li><li><a href="#v:project">project</a> :: <a href="Database-MongoDB-Query.html#t:Projector">Projector</a></li><li><a href="#v:skip">skip</a> :: <a href="../base-4.9.1.0/Data-Word.html#t:Word32">Word32</a></li><li><a href="#v:limit">limit</a> :: <a href="Database-MongoDB-Query.html#t:Limit">Limit</a></li><li><a href="#v:sort">sort</a> :: <a href="Database-MongoDB-Query.html#t:Order">Order</a></li><li><a href="#v:snapshot">snapshot</a> :: <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></li><li><a href="#v:batchSize">batchSize</a> :: <a href="Database-MongoDB-Query.html#t:BatchSize">BatchSize</a></li><li><a href="#v:hint">hint</a> :: <a href="Database-MongoDB-Query.html#t:Order">Order</a></li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:QueryOption">QueryOption</a><ul class="subs"><li>= <a href="#v:TailableCursor">TailableCursor</a></li><li>| <a href="#v:NoCursorTimeout">NoCursorTimeout</a></li><li>| <a href="#v:AwaitData">AwaitData</a></li><li>| <a href="#v:Partial">Partial</a></li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:Projector">Projector</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:Limit">Limit</a> = <a href="../base-4.9.1.0/Data-Word.html#t:Word32">Word32</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:Order">Order</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:BatchSize">BatchSize</a> = <a href="../base-4.9.1.0/Data-Word.html#t:Word32">Word32</a></li><li class="src short"><a href="#v:explain">explain</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Query">Query</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a></li><li class="src short"><a href="#v:find">find</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Query">Query</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="Database-MongoDB-Query.html#t:Cursor">Cursor</a></li><li class="src short"><a href="#v:findOne">findOne</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Query">Query</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m (<a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>)</li><li class="src short"><a href="#v:fetch">fetch</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Query">Query</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a></li><li class="src short"><a href="#v:findAndModify">findAndModify</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Query">Query</a> -&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m (<a href="../base-4.9.1.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>)</li><li class="src short"><a href="#v:findAndModifyOpts">findAndModifyOpts</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Query">Query</a> -&gt; <a href="Database-MongoDB-Query.html#t:FindAndModifyOpts">FindAndModifyOpts</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m (<a href="../base-4.9.1.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> (<a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>))</li><li class="src short"><span class="keyword">data</span> <a href="#t:FindAndModifyOpts">FindAndModifyOpts</a><ul class="subs"><li>= <a href="#v:FamRemove">FamRemove</a> <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></li><li>| <a href="#v:FamUpdate">FamUpdate</a> { <ul class="subs"><li><a href="#v:famUpdate">famUpdate</a> :: <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a></li><li><a href="#v:famNew">famNew</a> :: <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></li><li><a href="#v:famUpsert">famUpsert</a> :: <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></li></ul> }</li></ul></li><li class="src short"><a href="#v:defFamUpdateOpts">defFamUpdateOpts</a> :: <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> -&gt; <a href="Database-MongoDB-Query.html#t:FindAndModifyOpts">FindAndModifyOpts</a></li><li class="src short"><a href="#v:count">count</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Query">Query</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:distinct">distinct</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Label">Label</a> -&gt; <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="../bson-0.3.2.3/Data-Bson.html#t:Value">Value</a>]</li><li class="src short"><span class="keyword">data</span> <a href="#t:Cursor">Cursor</a></li><li class="src short"><a href="#v:nextBatch">nextBatch</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Cursor">Cursor</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>]</li><li class="src short"><a href="#v:next">next</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Cursor">Cursor</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m (<a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>)</li><li class="src short"><a href="#v:nextN">nextN</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Database-MongoDB-Query.html#t:Cursor">Cursor</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>]</li><li class="src short"><a href="#v:rest">rest</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Cursor">Cursor</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>]</li><li class="src short"><a href="#v:closeCursor">closeCursor</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Cursor">Cursor</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m ()</li><li class="src short"><a href="#v:isCursorClosed">isCursorClosed</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Cursor">Cursor</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:Pipeline">Pipeline</a> = [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>]</li><li class="src short"><a href="#v:aggregate">aggregate</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; <a href="Database-MongoDB-Query.html#t:Pipeline">Pipeline</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>]</li><li class="src short"><span class="keyword">data</span> <a href="#t:Group">Group</a> = <a href="#v:Group">Group</a> {<ul class="subs"><li><a href="#v:gColl">gColl</a> :: <a href="Database-MongoDB-Query.html#t:Collection">Collection</a></li><li><a href="#v:gKey">gKey</a> :: <a href="Database-MongoDB-Query.html#t:GroupKey">GroupKey</a></li><li><a href="#v:gReduce">gReduce</a> :: <a href="../bson-0.3.2.3/Data-Bson.html#t:Javascript">Javascript</a></li><li><a href="#v:gInitial">gInitial</a> :: <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a></li><li><a href="#v:gCond">gCond</a> :: <a href="Database-MongoDB-Query.html#t:Selector">Selector</a></li><li><a href="#v:gFinalize">gFinalize</a> :: <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="../bson-0.3.2.3/Data-Bson.html#t:Javascript">Javascript</a></li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:GroupKey">GroupKey</a><ul class="subs"><li>= <a href="#v:Key">Key</a> [<a href="../bson-0.3.2.3/Data-Bson.html#t:Label">Label</a>]</li><li>| <a href="#v:KeyF">KeyF</a> <a href="../bson-0.3.2.3/Data-Bson.html#t:Javascript">Javascript</a></li></ul></li><li class="src short"><a href="#v:group">group</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Group">Group</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>]</li><li class="src short"><span class="keyword">data</span> <a href="#t:MapReduce">MapReduce</a> = <a href="#v:MapReduce">MapReduce</a> {<ul class="subs"><li><a href="#v:rColl">rColl</a> :: <a href="Database-MongoDB-Query.html#t:Collection">Collection</a></li><li><a href="#v:rMap">rMap</a> :: <a href="Database-MongoDB-Query.html#t:MapFun">MapFun</a></li><li><a href="#v:rReduce">rReduce</a> :: <a href="Database-MongoDB-Query.html#t:ReduceFun">ReduceFun</a></li><li><a href="#v:rSelect">rSelect</a> :: <a href="Database-MongoDB-Query.html#t:Selector">Selector</a></li><li><a href="#v:rSort">rSort</a> :: <a href="Database-MongoDB-Query.html#t:Order">Order</a></li><li><a href="#v:rLimit">rLimit</a> :: <a href="Database-MongoDB-Query.html#t:Limit">Limit</a></li><li><a href="#v:rOut">rOut</a> :: <a href="Database-MongoDB-Query.html#t:MROut">MROut</a></li><li><a href="#v:rFinalize">rFinalize</a> :: <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Database-MongoDB-Query.html#t:FinalizeFun">FinalizeFun</a></li><li><a href="#v:rScope">rScope</a> :: <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a></li><li><a href="#v:rVerbose">rVerbose</a> :: <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:MapFun">MapFun</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Javascript">Javascript</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:ReduceFun">ReduceFun</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Javascript">Javascript</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:FinalizeFun">FinalizeFun</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Javascript">Javascript</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:MROut">MROut</a><ul class="subs"><li>= <a href="#v:Inline">Inline</a></li><li>| <a href="#v:Output">Output</a> <a href="Database-MongoDB-Query.html#t:MRMerge">MRMerge</a> <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> (<a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Database-MongoDB-Query.html#t:Database">Database</a>)</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:MRMerge">MRMerge</a><ul class="subs"><li>= <a href="#v:Replace">Replace</a></li><li>| <a href="#v:Merge">Merge</a></li><li>| <a href="#v:Reduce">Reduce</a></li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:MRResult">MRResult</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a></li><li class="src short"><a href="#v:mapReduce">mapReduce</a> :: <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; <a href="Database-MongoDB-Query.html#t:MapFun">MapFun</a> -&gt; <a href="Database-MongoDB-Query.html#t:ReduceFun">ReduceFun</a> -&gt; <a href="Database-MongoDB-Query.html#t:MapReduce">MapReduce</a></li><li class="src short"><a href="#v:runMR">runMR</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:MapReduce">MapReduce</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="Database-MongoDB-Query.html#t:Cursor">Cursor</a></li><li class="src short"><a href="#v:runMR-39-">runMR'</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:MapReduce">MapReduce</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="Database-MongoDB-Query.html#t:MRResult">MRResult</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:Command">Command</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a></li><li class="src short"><a href="#v:runCommand">runCommand</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Command">Command</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a></li><li class="src short"><a href="#v:runCommand1">runCommand1</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="../text-1.2.2.2/Data-Text.html#t:Text">Text</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a></li><li class="src short"><a href="#v:eval">eval</a> :: (<a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m, <a href="../bson-0.3.2.3/Data-Bson.html#t:Val">Val</a> v) =&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Javascript">Javascript</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m v</li><li class="src short"><a href="#v:retrieveServerData">retrieveServerData</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="Database-MongoDB-Query.html#t:ServerData">ServerData</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:ServerData">ServerData</a> = <a href="#v:ServerData">ServerData</a> {<ul class="subs"><li><a href="#v:isMaster">isMaster</a> :: <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></li><li><a href="#v:minWireVersion">minWireVersion</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></li><li><a href="#v:maxWireVersion">maxWireVersion</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></li><li><a href="#v:maxMessageSizeBytes">maxMessageSizeBytes</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></li><li><a href="#v:maxBsonObjectSize">maxBsonObjectSize</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></li><li><a href="#v:maxWriteBatchSize">maxWriteBatchSize</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></li></ul>}</li></ul></div><div id="interface"><h1 id="g:1">Monad</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Action" class="def">Action</a> = <a href="../mtl-2.2.1/Control-Monad-Reader.html#t:ReaderT">ReaderT</a> <a href="Database-MongoDB-Query.html#t:MongoContext">MongoContext</a> <a href="src/Database.MongoDB.Query.html#Action" class="link">Source</a> <a href="#t:Action" class="selflink">#</a></p><div class="doc"><p>A monad on top of m (which must be a MonadIO) that may access the database and may fail with a DB <code><a href="Database-MongoDB-Query.html#t:Failure">Failure</a></code></p></div></div><div class="top"><p class="src"><a id="v:access" class="def">access</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Connection.html#t:Pipe">Pipe</a> -&gt; <a href="Database-MongoDB-Query.html#t:AccessMode">AccessMode</a> -&gt; <a href="Database-MongoDB-Query.html#t:Database">Database</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m a -&gt; m a <a href="src/Database.MongoDB.Query.html#access" class="link">Source</a> <a href="#v:access" class="selflink">#</a></p><div class="doc"><p>Run action against database on server at other end of pipe. Use access mode for any reads and writes.
 Throw <code><a href="Database-MongoDB-Query.html#t:Failure">Failure</a></code> in case of any error.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Failure" class="def">Failure</a> <a href="src/Database.MongoDB.Query.html#Failure" class="link">Source</a> <a href="#t:Failure" class="selflink">#</a></p><div class="doc"><p>A connection failure, or a read or write exception like cursor expired or inserting a duplicate key.
 Note, unexpected data from the server is not a Failure, rather it is a programming error (you should call <code><a href="../base-4.9.1.0/Prelude.html#v:error">error</a></code> in this case) because the client and server are incompatible and requires a programming change.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:ConnectionFailure" class="def">ConnectionFailure</a> <a href="../base-4.9.1.0/System-IO-Error.html#t:IOError">IOError</a></td><td class="doc"><p>TCP connection (<code><a href="Database-MongoDB-Query.html#t:Pipeline">Pipeline</a></code>) failed. May work if you try again on the same Mongo <code>Connection</code> which will create a new Pipe.</p></td></tr><tr><td class="src"><a id="v:CursorNotFoundFailure" class="def">CursorNotFoundFailure</a> CursorId</td><td class="doc"><p>Cursor expired because it wasn't accessed for over 10 minutes, or this cursor came from a different server that the one you are currently connected to (perhaps a fail over happen between servers in a replica set)</p></td></tr><tr><td class="src"><a id="v:QueryFailure" class="def">QueryFailure</a> <a href="Database-MongoDB-Query.html#t:ErrorCode">ErrorCode</a> <a href="../base-4.9.1.0/Data-String.html#t:String">String</a></td><td class="doc"><p>Query failed for some reason as described in the string</p></td></tr><tr><td class="src"><a id="v:WriteFailure" class="def">WriteFailure</a> <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> <a href="Database-MongoDB-Query.html#t:ErrorCode">ErrorCode</a> <a href="../base-4.9.1.0/Data-String.html#t:String">String</a></td><td class="doc"><p>Error observed by getLastError after a write, error description is in string, index of failed document is the first argument</p></td></tr><tr><td class="src"><a id="v:WriteConcernFailure" class="def">WriteConcernFailure</a> <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> <a href="../base-4.9.1.0/Data-String.html#t:String">String</a></td><td class="doc"><p>Write concern error. It's reported only by insert, update, delete commands. Not by wire protocol.</p></td></tr><tr><td class="src"><a id="v:DocNotFound" class="def">DocNotFound</a> <a href="Database-MongoDB-Query.html#t:Selection">Selection</a></td><td class="doc"><p><code><a href="Database-MongoDB-Query.html#v:fetch">fetch</a></code> found no document matching selection</p></td></tr><tr><td class="src"><a id="v:AggregateFailure" class="def">AggregateFailure</a> <a href="../base-4.9.1.0/Data-String.html#t:String">String</a></td><td class="doc"><p><code><a href="Database-MongoDB-Query.html#v:aggregate">aggregate</a></code> returned an error</p></td></tr><tr><td class="src"><a id="v:CompoundFailure" class="def">CompoundFailure</a> [<a href="Database-MongoDB-Query.html#t:Failure">Failure</a>]</td><td class="doc"><p>When we need to aggregate several failures and report them.</p></td></tr><tr><td class="src"><a id="v:ProtocolFailure" class="def">ProtocolFailure</a> <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> <a href="../base-4.9.1.0/Data-String.html#t:String">String</a></td><td class="doc"><p>The structure of the returned documents doesn't match what we expected</p></td></tr></table></div><div class="subs instances"><p id="control.i:Failure" class="caption collapser" onclick="toggleSection('i:Failure')">Instances</p><div id="section.i:Failure" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Failure:Eq:1" class="instance expander" onclick="toggleSection('i:id:Failure:Eq:1')"></span> <a href="../base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> <a href="Database-MongoDB-Query.html#t:Failure">Failure</a></span> <a href="src/Database.MongoDB.Query.html#line-134" class="link">Source</a> <a href="#t:Failure" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Failure:Eq:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Database-MongoDB-Query.html#t:Failure">Failure</a> -&gt; <a href="Database-MongoDB-Query.html#t:Failure">Failure</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Database-MongoDB-Query.html#t:Failure">Failure</a> -&gt; <a href="Database-MongoDB-Query.html#t:Failure">Failure</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Failure:Show:2" class="instance expander" onclick="toggleSection('i:id:Failure:Show:2')"></span> <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> <a href="Database-MongoDB-Query.html#t:Failure">Failure</a></span> <a href="src/Database.MongoDB.Query.html#line-134" class="link">Source</a> <a href="#t:Failure" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Failure:Show:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Database-MongoDB-Query.html#t:Failure">Failure</a> -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Database-MongoDB-Query.html#t:Failure">Failure</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Database-MongoDB-Query.html#t:Failure">Failure</a>] -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Failure:Exception:3" class="instance expander" onclick="toggleSection('i:id:Failure:Exception:3')"></span> <a href="../base-4.9.1.0/Control-Exception-Base.html#t:Exception">Exception</a> <a href="Database-MongoDB-Query.html#t:Failure">Failure</a></span> <a href="src/Database.MongoDB.Query.html#line-135" class="link">Source</a> <a href="#t:Failure" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Failure:Exception:3" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toException">toException</a> :: <a href="Database-MongoDB-Query.html#t:Failure">Failure</a> -&gt; <a href="../base-4.9.1.0/Control-Exception-Base.html#t:SomeException">SomeException</a> <a href="#v:toException" class="selflink">#</a></p><p class="src"><a href="#v:fromException">fromException</a> :: <a href="../base-4.9.1.0/Control-Exception-Base.html#t:SomeException">SomeException</a> -&gt; <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Database-MongoDB-Query.html#t:Failure">Failure</a> <a href="#v:fromException" class="selflink">#</a></p><p class="src"><a href="#v:displayException">displayException</a> :: <a href="Database-MongoDB-Query.html#t:Failure">Failure</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:displayException" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Failure:Error:4" class="instance expander" onclick="toggleSection('i:id:Failure:Error:4')"></span> <a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:Error">Error</a> <a href="Database-MongoDB-Query.html#t:Failure">Failure</a></span> <a href="src/Database.MongoDB.Query.html#line-140" class="link">Source</a> <a href="#t:Failure" class="selflink">#</a></td><td class="doc"><p><code><a href="../base-4.9.1.0/Control-Monad.html#v:fail">fail</a></code> is treated the same as a programming <code><a href="../base-4.9.1.0/Prelude.html#v:error">error</a></code>. In other words, don't use it.</p></td></tr><tr><td colspan="2"><div id="section.i:id:Failure:Error:4" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:noMsg">noMsg</a> :: <a href="Database-MongoDB-Query.html#t:Failure">Failure</a> <a href="#v:noMsg" class="selflink">#</a></p><p class="src"><a href="#v:strMsg">strMsg</a> :: <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; <a href="Database-MongoDB-Query.html#t:Failure">Failure</a> <a href="#v:strMsg" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:ErrorCode" class="def">ErrorCode</a> = <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> <a href="src/Database.MongoDB.Query.html#ErrorCode" class="link">Source</a> <a href="#t:ErrorCode" class="selflink">#</a></p><div class="doc"><p>Error code from getLastError or query failure</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:AccessMode" class="def">AccessMode</a> <a href="src/Database.MongoDB.Query.html#AccessMode" class="link">Source</a> <a href="#t:AccessMode" class="selflink">#</a></p><div class="doc"><p>Type of reads and writes to perform</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:ReadStaleOk" class="def">ReadStaleOk</a></td><td class="doc"><p>Read-only action, reading stale data from a slave is OK.</p></td></tr><tr><td class="src"><a id="v:UnconfirmedWrites" class="def">UnconfirmedWrites</a></td><td class="doc"><p>Read-write action, slave not OK, every write is fire &amp; forget.</p></td></tr><tr><td class="src"><a id="v:ConfirmWrites" class="def">ConfirmWrites</a> <a href="Database-MongoDB-Query.html#t:GetLastError">GetLastError</a></td><td class="doc"><p>Read-write action, slave not OK, every write is confirmed with getLastError.</p></td></tr></table></div><div class="subs instances"><p id="control.i:AccessMode" class="caption collapser" onclick="toggleSection('i:AccessMode')">Instances</p><div id="section.i:AccessMode" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:AccessMode:Show:1" class="instance expander" onclick="toggleSection('i:id:AccessMode:Show:1')"></span> <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> <a href="Database-MongoDB-Query.html#t:AccessMode">AccessMode</a></span> <a href="src/Database.MongoDB.Query.html#line-148" class="link">Source</a> <a href="#t:AccessMode" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:AccessMode:Show:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Database-MongoDB-Query.html#t:AccessMode">AccessMode</a> -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Database-MongoDB-Query.html#t:AccessMode">AccessMode</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Database-MongoDB-Query.html#t:AccessMode">AccessMode</a>] -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:GetLastError" class="def">GetLastError</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> <a href="src/Database.MongoDB.Query.html#GetLastError" class="link">Source</a> <a href="#t:GetLastError" class="selflink">#</a></p><div class="doc"><p>Parameters for getLastError command. For example <code>[&quot;w&quot; =: 2]</code> tells the server to wait for the write to reach at least two servers in replica set before acknowledging. See <a href="http://www.mongodb.org/display/DOCS/Last+Error+Commands">http://www.mongodb.org/display/DOCS/Last+Error+Commands</a> for more options.</p></div></div><div class="top"><p class="src"><a id="v:master" class="def">master</a> :: <a href="Database-MongoDB-Query.html#t:AccessMode">AccessMode</a> <a href="src/Database.MongoDB.Query.html#master" class="link">Source</a> <a href="#v:master" class="selflink">#</a></p><div class="doc"><p>Same as <code><a href="Database-MongoDB-Query.html#v:ConfirmWrites">ConfirmWrites</a></code> []</p></div></div><div class="top"><p class="src"><a id="v:slaveOk" class="def">slaveOk</a> :: <a href="Database-MongoDB-Query.html#t:AccessMode">AccessMode</a> <a href="src/Database.MongoDB.Query.html#slaveOk" class="link">Source</a> <a href="#v:slaveOk" class="selflink">#</a></p><div class="doc"><p>Same as <code><a href="Database-MongoDB-Query.html#v:ReadStaleOk">ReadStaleOk</a></code></p></div></div><div class="top"><p class="src"><a id="v:accessMode" class="def">accessMode</a> :: <a href="../base-4.9.1.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Database-MongoDB-Query.html#t:AccessMode">AccessMode</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m a -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m a <a href="src/Database.MongoDB.Query.html#accessMode" class="link">Source</a> <a href="#v:accessMode" class="selflink">#</a></p><div class="doc"><p>Run action with given <code><a href="Database-MongoDB-Query.html#t:AccessMode">AccessMode</a></code></p></div></div><div class="top"><p class="src"><a id="v:liftDB" class="def">liftDB</a> :: (<a href="../mtl-2.2.1/Control-Monad-Reader-Class.html#t:MonadReader">MonadReader</a> env m, <a href="Database-MongoDB-Query.html#t:HasMongoContext">HasMongoContext</a> env, <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m) =&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> <a href="../base-4.9.1.0/System-IO.html#t:IO">IO</a> a -&gt; m a <a href="src/Database.MongoDB.Query.html#liftDB" class="link">Source</a> <a href="#v:liftDB" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:MongoContext" class="def">MongoContext</a> <a href="src/Database.MongoDB.Query.html#MongoContext" class="link">Source</a> <a href="#t:MongoContext" class="selflink">#</a></p><div class="doc"><p>Values needed when executing a db operation</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:MongoContext" class="def">MongoContext</a></td><td class="doc"><p>operations query/update this database</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:mongoPipe" class="def">mongoPipe</a> :: <a href="Database-MongoDB-Connection.html#t:Pipe">Pipe</a></dfn><div class="doc"><p>operations read/write to this pipelined TCP connection to a MongoDB server</p></div></li><li><dfn class="src"><a id="v:mongoAccessMode" class="def">mongoAccessMode</a> :: <a href="Database-MongoDB-Query.html#t:AccessMode">AccessMode</a></dfn><div class="doc"><p>read/write operation will use this access mode</p></div></li><li><dfn class="src"><a id="v:mongoDatabase" class="def">mongoDatabase</a> :: <a href="Database-MongoDB-Query.html#t:Database">Database</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:MongoContext" class="caption collapser" onclick="toggleSection('i:MongoContext')">Instances</p><div id="section.i:MongoContext" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:MongoContext:HasMongoContext:1" class="instance expander" onclick="toggleSection('i:id:MongoContext:HasMongoContext:1')"></span> <a href="Database-MongoDB-Query.html#t:HasMongoContext">HasMongoContext</a> <a href="Database-MongoDB-Query.html#t:MongoContext">MongoContext</a></span> <a href="src/Database.MongoDB.Query.html#line-215" class="link">Source</a> <a href="#t:MongoContext" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:MongoContext:HasMongoContext:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:mongoContext">mongoContext</a> :: <a href="Database-MongoDB-Query.html#t:MongoContext">MongoContext</a> -&gt; <a href="Database-MongoDB-Query.html#t:MongoContext">MongoContext</a> <a href="src/Database.MongoDB.Query.html#mongoContext" class="link">Source</a> <a href="#v:mongoContext" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a id="t:HasMongoContext" class="def">HasMongoContext</a> env <span class="keyword">where</span> <a href="src/Database.MongoDB.Query.html#HasMongoContext" class="link">Source</a> <a href="#t:HasMongoContext" class="selflink">#</a></p><div class="subs minimal"><p class="caption">Minimal complete definition</p><p class="src"><a href="Database-MongoDB-Query.html#v:mongoContext">mongoContext</a></p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a id="v:mongoContext" class="def">mongoContext</a> :: env -&gt; <a href="Database-MongoDB-Query.html#t:MongoContext">MongoContext</a> <a href="src/Database.MongoDB.Query.html#mongoContext" class="link">Source</a> <a href="#v:mongoContext" class="selflink">#</a></p></div><div class="subs instances"><p id="control.i:HasMongoContext" class="caption collapser" onclick="toggleSection('i:HasMongoContext')">Instances</p><div id="section.i:HasMongoContext" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:ic:HasMongoContext:HasMongoContext:1" class="instance expander" onclick="toggleSection('i:ic:HasMongoContext:HasMongoContext:1')"></span> <a href="Database-MongoDB-Query.html#t:HasMongoContext">HasMongoContext</a> <a href="Database-MongoDB-Query.html#t:MongoContext">MongoContext</a></span> <a href="src/Database.MongoDB.Query.html#line-215" class="link">Source</a> <a href="#t:HasMongoContext" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:ic:HasMongoContext:HasMongoContext:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:mongoContext">mongoContext</a> :: <a href="Database-MongoDB-Query.html#t:MongoContext">MongoContext</a> -&gt; <a href="Database-MongoDB-Query.html#t:MongoContext">MongoContext</a> <a href="src/Database.MongoDB.Query.html#mongoContext" class="link">Source</a> <a href="#v:mongoContext" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><h1 id="g:2">Database</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Database" class="def">Database</a> = <a href="../text-1.2.2.2/Data-Text.html#t:Text">Text</a> <a href="src/Database.MongoDB.Query.html#Database" class="link">Source</a> <a href="#t:Database" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:allDatabases" class="def">allDatabases</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="Database-MongoDB-Query.html#t:Database">Database</a>] <a href="src/Database.MongoDB.Query.html#allDatabases" class="link">Source</a> <a href="#v:allDatabases" class="selflink">#</a></p><div class="doc"><p>List all databases residing on server</p></div></div><div class="top"><p class="src"><a id="v:useDb" class="def">useDb</a> :: <a href="../base-4.9.1.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Database">Database</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m a -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m a <a href="src/Database.MongoDB.Query.html#useDb" class="link">Source</a> <a href="#v:useDb" class="selflink">#</a></p><div class="doc"><p>Run action against given database</p></div></div><div class="top"><p class="src"><a id="v:thisDatabase" class="def">thisDatabase</a> :: <a href="../base-4.9.1.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="Database-MongoDB-Query.html#t:Database">Database</a> <a href="src/Database.MongoDB.Query.html#thisDatabase" class="link">Source</a> <a href="#v:thisDatabase" class="selflink">#</a></p><div class="doc"><p>Current database in use</p></div></div><h2 id="g:3">Authentication</h2><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Username" class="def">Username</a> = <a href="../text-1.2.2.2/Data-Text.html#t:Text">Text</a> <a href="src/Database.MongoDB.Internal.Protocol.html#Username" class="link">Source</a> <a href="#t:Username" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Password" class="def">Password</a> = <a href="../text-1.2.2.2/Data-Text.html#t:Text">Text</a> <a href="src/Database.MongoDB.Internal.Protocol.html#Password" class="link">Source</a> <a href="#t:Password" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:auth" class="def">auth</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Username">Username</a> -&gt; <a href="Database-MongoDB-Query.html#t:Password">Password</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Database.MongoDB.Query.html#auth" class="link">Source</a> <a href="#v:auth" class="selflink">#</a></p><div class="doc"><p>Authenticate with the current database (if server is running in secure mode). Return whether authentication was successful or not. Reauthentication is required for every new pipe. SCRAM-SHA-1 will be used for server versions 3.0+, MONGO-CR for lower versions.</p></div></div><div class="top"><p class="src"><a id="v:authMongoCR" class="def">authMongoCR</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Username">Username</a> -&gt; <a href="Database-MongoDB-Query.html#t:Password">Password</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Database.MongoDB.Query.html#authMongoCR" class="link">Source</a> <a href="#v:authMongoCR" class="selflink">#</a></p><div class="doc"><p>Authenticate with the current database, using the MongoDB-CR authentication mechanism (default in MongoDB server &lt; 3.0)</p></div></div><div class="top"><p class="src"><a id="v:authSCRAMSHA1" class="def">authSCRAMSHA1</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Username">Username</a> -&gt; <a href="Database-MongoDB-Query.html#t:Password">Password</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Database.MongoDB.Query.html#authSCRAMSHA1" class="link">Source</a> <a href="#v:authSCRAMSHA1" class="selflink">#</a></p><div class="doc"><p>Authenticate with the current database, using the SCRAM-SHA-1 authentication mechanism (default in MongoDB server &gt;= 3.0)</p></div></div><h1 id="g:4">Collection</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Collection" class="def">Collection</a> = <a href="../text-1.2.2.2/Data-Text.html#t:Text">Text</a> <a href="src/Database.MongoDB.Query.html#Collection" class="link">Source</a> <a href="#t:Collection" class="selflink">#</a></p><div class="doc"><p>Collection name (not prefixed with database)</p></div></div><div class="top"><p class="src"><a id="v:allCollections" class="def">allCollections</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="Database-MongoDB-Query.html#t:Collection">Collection</a>] <a href="src/Database.MongoDB.Query.html#allCollections" class="link">Source</a> <a href="#v:allCollections" class="selflink">#</a></p><div class="doc"><p>List all collections in this database</p></div></div><h2 id="g:5">Selection</h2><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Selection" class="def">Selection</a> <a href="src/Database.MongoDB.Query.html#Selection" class="link">Source</a> <a href="#t:Selection" class="selflink">#</a></p><div class="doc"><p>Selects documents in collection that match selector</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Select" class="def">Select</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:selector" class="def">selector</a> :: <a href="Database-MongoDB-Query.html#t:Selector">Selector</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:coll" class="def">coll</a> :: <a href="Database-MongoDB-Query.html#t:Collection">Collection</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:Selection" class="caption collapser" onclick="toggleSection('i:Selection')">Instances</p><div id="section.i:Selection" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Selection:Eq:1" class="instance expander" onclick="toggleSection('i:id:Selection:Eq:1')"></span> <a href="../base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> <a href="Database-MongoDB-Query.html#t:Selection">Selection</a></span> <a href="src/Database.MongoDB.Query.html#line-373" class="link">Source</a> <a href="#t:Selection" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Selection:Eq:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Selection:Show:2" class="instance expander" onclick="toggleSection('i:id:Selection:Show:2')"></span> <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> <a href="Database-MongoDB-Query.html#t:Selection">Selection</a></span> <a href="src/Database.MongoDB.Query.html#line-373" class="link">Source</a> <a href="#t:Selection" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Selection:Show:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Database-MongoDB-Query.html#t:Selection">Selection</a>] -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Selection:Select:3" class="instance expander" onclick="toggleSection('i:id:Selection:Select:3')"></span> <a href="Database-MongoDB-Query.html#t:Select">Select</a> <a href="Database-MongoDB-Query.html#t:Selection">Selection</a></span> <a href="src/Database.MongoDB.Query.html#line-387" class="link">Source</a> <a href="#t:Selection" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Selection:Select:3" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:select">select</a> :: <a href="Database-MongoDB-Query.html#t:Selector">Selector</a> -&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> <a href="src/Database.MongoDB.Query.html#select" class="link">Source</a> <a href="#v:select" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Selector" class="def">Selector</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> <a href="src/Database.MongoDB.Query.html#Selector" class="link">Source</a> <a href="#t:Selector" class="selflink">#</a></p><div class="doc"><p>Filter for a query, analogous to the where clause in SQL. <code>[]</code> matches all documents in collection. <code>[&quot;x&quot; =: a, &quot;y&quot; =: b]</code> is analogous to <code>where x = a and y = b</code> in SQL. See <a href="http://www.mongodb.org/display/DOCS/Querying">http://www.mongodb.org/display/DOCS/Querying</a> for full selector syntax.</p></div></div><div class="top"><p class="src"><a id="v:whereJS" class="def">whereJS</a> :: <a href="Database-MongoDB-Query.html#t:Selector">Selector</a> -&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Javascript">Javascript</a> -&gt; <a href="Database-MongoDB-Query.html#t:Selector">Selector</a> <a href="src/Database.MongoDB.Query.html#whereJS" class="link">Source</a> <a href="#v:whereJS" class="selflink">#</a></p><div class="doc"><p>Add Javascript predicate to selector, in which case a document must match both selector and predicate</p></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a id="t:Select" class="def">Select</a> aQueryOrSelection <span class="keyword">where</span> <a href="src/Database.MongoDB.Query.html#Select" class="link">Source</a> <a href="#t:Select" class="selflink">#</a></p><div class="subs minimal"><p class="caption">Minimal complete definition</p><p class="src"><a href="Database-MongoDB-Query.html#v:select">select</a></p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a id="v:select" class="def">select</a> :: <a href="Database-MongoDB-Query.html#t:Selector">Selector</a> -&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; aQueryOrSelection <a href="src/Database.MongoDB.Query.html#select" class="link">Source</a> <a href="#v:select" class="selflink">#</a></p><div class="doc"><p><code><a href="Database-MongoDB-Query.html#t:Query">Query</a></code> or <code><a href="Database-MongoDB-Query.html#t:Selection">Selection</a></code> that selects documents in collection that match selector. The choice of type depends on use, for example, in <code><code><a href="Database-MongoDB-Query.html#v:find">find</a></code> (select sel col)</code> it is a Query, and in <code><code><a href="Database-MongoDB-Query.html#v:delete">delete</a></code> (select sel col)</code> it is a Selection.</p></div></div><div class="subs instances"><p id="control.i:Select" class="caption collapser" onclick="toggleSection('i:Select')">Instances</p><div id="section.i:Select" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:ic:Select:Select:1" class="instance expander" onclick="toggleSection('i:ic:Select:Select:1')"></span> <a href="Database-MongoDB-Query.html#t:Select">Select</a> <a href="Database-MongoDB-Query.html#t:Query">Query</a></span> <a href="src/Database.MongoDB.Query.html#line-390" class="link">Source</a> <a href="#t:Select" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:ic:Select:Select:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:select">select</a> :: <a href="Database-MongoDB-Query.html#t:Selector">Selector</a> -&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; <a href="Database-MongoDB-Query.html#t:Query">Query</a> <a href="src/Database.MongoDB.Query.html#select" class="link">Source</a> <a href="#v:select" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:ic:Select:Select:2" class="instance expander" onclick="toggleSection('i:ic:Select:Select:2')"></span> <a href="Database-MongoDB-Query.html#t:Select">Select</a> <a href="Database-MongoDB-Query.html#t:Selection">Selection</a></span> <a href="src/Database.MongoDB.Query.html#line-387" class="link">Source</a> <a href="#t:Select" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:ic:Select:Select:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:select">select</a> :: <a href="Database-MongoDB-Query.html#t:Selector">Selector</a> -&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> <a href="src/Database.MongoDB.Query.html#select" class="link">Source</a> <a href="#v:select" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><h1 id="g:6">Write</h1><h2 id="g:7">Insert</h2><div class="top"><p class="src"><a id="v:insert" class="def">insert</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../bson-0.3.2.3/Data-Bson.html#t:Value">Value</a> <a href="src/Database.MongoDB.Query.html#insert" class="link">Source</a> <a href="#v:insert" class="selflink">#</a></p><div class="doc"><p>Insert document into collection and return its &quot;_id&quot; value, which is created automatically if not supplied</p></div></div><div class="top"><p class="src"><a id="v:insert_" class="def">insert_</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m () <a href="src/Database.MongoDB.Query.html#insert_" class="link">Source</a> <a href="#v:insert_" class="selflink">#</a></p><div class="doc"><p>Same as <code><a href="Database-MongoDB-Query.html#v:insert">insert</a></code> except don't return _id</p></div></div><div class="top"><p class="src"><a id="v:insertMany" class="def">insertMany</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>] -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="../bson-0.3.2.3/Data-Bson.html#t:Value">Value</a>] <a href="src/Database.MongoDB.Query.html#insertMany" class="link">Source</a> <a href="#v:insertMany" class="selflink">#</a></p><div class="doc"><p>Insert documents into collection and return their &quot;_id&quot; values,
 which are created automatically if not supplied.
 If a document fails to be inserted (eg. due to duplicate key)
 then remaining docs are aborted, and LastError is set.
 An exception will be throw if any error occurs.</p></div></div><div class="top"><p class="src"><a id="v:insertMany_" class="def">insertMany_</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>] -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m () <a href="src/Database.MongoDB.Query.html#insertMany_" class="link">Source</a> <a href="#v:insertMany_" class="selflink">#</a></p><div class="doc"><p>Same as <code><a href="Database-MongoDB-Query.html#v:insertMany">insertMany</a></code> except don't return _ids</p></div></div><div class="top"><p class="src"><a id="v:insertAll" class="def">insertAll</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>] -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="../bson-0.3.2.3/Data-Bson.html#t:Value">Value</a>] <a href="src/Database.MongoDB.Query.html#insertAll" class="link">Source</a> <a href="#v:insertAll" class="selflink">#</a></p><div class="doc"><p>Insert documents into collection and return their &quot;_id&quot; values,
 which are created automatically if not supplied. If a document fails
 to be inserted (eg. due to duplicate key) then remaining docs
 are still inserted.</p></div></div><div class="top"><p class="src"><a id="v:insertAll_" class="def">insertAll_</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>] -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m () <a href="src/Database.MongoDB.Query.html#insertAll_" class="link">Source</a> <a href="#v:insertAll_" class="selflink">#</a></p><div class="doc"><p>Same as <code><a href="Database-MongoDB-Query.html#v:insertAll">insertAll</a></code> except don't return _ids</p></div></div><h2 id="g:8">Update</h2><div class="top"><p class="src"><a id="v:save" class="def">save</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m () <a href="src/Database.MongoDB.Query.html#save" class="link">Source</a> <a href="#v:save" class="selflink">#</a></p><div class="doc"><p>Save document to collection, meaning insert it if its new (has no &quot;_id&quot; field) or upsert it if its not new (has &quot;_id&quot; field)</p></div></div><div class="top"><p class="src"><a id="v:replace" class="def">replace</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m () <a href="src/Database.MongoDB.Query.html#replace" class="link">Source</a> <a href="#v:replace" class="selflink">#</a></p><div class="doc"><p>Replace first document in selection with given document</p></div></div><div class="top"><p class="src"><a id="v:repsert" class="def">repsert</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m () <a href="src/Database.MongoDB.Query.html#repsert" class="link">Source</a> <a href="#v:repsert" class="selflink">#</a></p><div class="doc"><div class="warning"><p>Deprecated: use upsert instead</p></div><p>Replace first document in selection with given document, or insert document if selection is empty</p></div></div><div class="top"><p class="src"><a id="v:upsert" class="def">upsert</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m () <a href="src/Database.MongoDB.Query.html#upsert" class="link">Source</a> <a href="#v:upsert" class="selflink">#</a></p><div class="doc"><p>Update first document in selection with given document, or insert document if selection is empty</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Modifier" class="def">Modifier</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> <a href="src/Database.MongoDB.Query.html#Modifier" class="link">Source</a> <a href="#t:Modifier" class="selflink">#</a></p><div class="doc"><p>Update operations on fields in a document. See <a href="http://www.mongodb.org/display/DOCS/Updating#Updating-ModifierOperations">http://www.mongodb.org/display/DOCS/Updating#Updating-ModifierOperations</a></p></div></div><div class="top"><p class="src"><a id="v:modify" class="def">modify</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="Database-MongoDB-Query.html#t:Modifier">Modifier</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m () <a href="src/Database.MongoDB.Query.html#modify" class="link">Source</a> <a href="#v:modify" class="selflink">#</a></p><div class="doc"><p>Update all documents in selection using given modifier</p></div></div><div class="top"><p class="src"><a id="v:updateMany" class="def">updateMany</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; [(<a href="Database-MongoDB-Query.html#t:Selector">Selector</a>, <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>, [<a href="Database-MongoDB-Query.html#t:UpdateOption">UpdateOption</a>])] -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="Database-MongoDB-Query.html#t:WriteResult">WriteResult</a> <a href="src/Database.MongoDB.Query.html#updateMany" class="link">Source</a> <a href="#v:updateMany" class="selflink">#</a></p><div class="doc"><p>Bulk update operation. If one update fails it will not update the remaining
 - documents. Current returned value is only a place holder. With mongodb server
 - before 2.6 it will send update requests one by one. In order to receive
 - error messages in versions under 2.6 you need to user confirmed writes.
 - Otherwise even if the errors had place the list of errors will be empty and
 - the result will be success.  After 2.6 it will use bulk update feature in
 - mongodb.</p></div></div><div class="top"><p class="src"><a id="v:updateAll" class="def">updateAll</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; [(<a href="Database-MongoDB-Query.html#t:Selector">Selector</a>, <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>, [<a href="Database-MongoDB-Query.html#t:UpdateOption">UpdateOption</a>])] -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="Database-MongoDB-Query.html#t:WriteResult">WriteResult</a> <a href="src/Database.MongoDB.Query.html#updateAll" class="link">Source</a> <a href="#v:updateAll" class="selflink">#</a></p><div class="doc"><p>Bulk update operation. If one update fails it will proceed with the
 - remaining documents. With mongodb server before 2.6 it will send update
 - requests one by one. In order to receive error messages in versions under
 - 2.6 you need to use confirmed writes.  Otherwise even if the errors had
 - place the list of errors will be empty and the result will be success.
 - After 2.6 it will use bulk update feature in mongodb.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:WriteResult" class="def">WriteResult</a> <a href="src/Database.MongoDB.Query.html#WriteResult" class="link">Source</a> <a href="#t:WriteResult" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:WriteResult" class="def">WriteResult</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:failed" class="def">failed</a> :: <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:nMatched" class="def">nMatched</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:nModified" class="def">nModified</a> :: <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:nRemoved" class="def">nRemoved</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></dfn><div class="doc"><p>Mongodb server before 2.6 doesn't allow to calculate this value.
 This field is meaningless if we can't calculate the number of modified documents.</p></div></li><li><dfn class="src"><a id="v:upserted" class="def">upserted</a> :: [<a href="Database-MongoDB-Query.html#t:Upserted">Upserted</a>]</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:writeErrors" class="def">writeErrors</a> :: [<a href="Database-MongoDB-Query.html#t:Failure">Failure</a>]</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:writeConcernErrors" class="def">writeConcernErrors</a> :: [<a href="Database-MongoDB-Query.html#t:Failure">Failure</a>]</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:WriteResult" class="caption collapser" onclick="toggleSection('i:WriteResult')">Instances</p><div id="section.i:WriteResult" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:WriteResult:Show:1" class="instance expander" onclick="toggleSection('i:id:WriteResult:Show:1')"></span> <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> <a href="Database-MongoDB-Query.html#t:WriteResult">WriteResult</a></span> <a href="src/Database.MongoDB.Query.html#line-166" class="link">Source</a> <a href="#t:WriteResult" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:WriteResult:Show:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Database-MongoDB-Query.html#t:WriteResult">WriteResult</a> -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Database-MongoDB-Query.html#t:WriteResult">WriteResult</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Database-MongoDB-Query.html#t:WriteResult">WriteResult</a>] -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:UpdateOption" class="def">UpdateOption</a> <a href="src/Database.MongoDB.Internal.Protocol.html#UpdateOption" class="link">Source</a> <a href="#t:UpdateOption" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Upsert" class="def">Upsert</a></td><td class="doc"><p>If set, the database will insert the supplied object into the collection if no matching document is found</p></td></tr><tr><td class="src"><a id="v:MultiUpdate" class="def">MultiUpdate</a></td><td class="doc"><p>If set, the database will update all matching objects in the collection. Otherwise only updates first matching doc</p></td></tr></table></div><div class="subs instances"><p id="control.i:UpdateOption" class="caption collapser" onclick="toggleSection('i:UpdateOption')">Instances</p><div id="section.i:UpdateOption" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:UpdateOption:Eq:1" class="instance expander" onclick="toggleSection('i:id:UpdateOption:Eq:1')"></span> <a href="../base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> <a href="Database-MongoDB-Query.html#t:UpdateOption">UpdateOption</a></span> <a href="src/Database.MongoDB.Internal.Protocol.html#line-314" class="link">Source</a> <a href="#t:UpdateOption" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:UpdateOption:Eq:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Database-MongoDB-Query.html#t:UpdateOption">UpdateOption</a> -&gt; <a href="Database-MongoDB-Query.html#t:UpdateOption">UpdateOption</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Database-MongoDB-Query.html#t:UpdateOption">UpdateOption</a> -&gt; <a href="Database-MongoDB-Query.html#t:UpdateOption">UpdateOption</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:UpdateOption:Show:2" class="instance expander" onclick="toggleSection('i:id:UpdateOption:Show:2')"></span> <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> <a href="Database-MongoDB-Query.html#t:UpdateOption">UpdateOption</a></span> <a href="src/Database.MongoDB.Internal.Protocol.html#line-314" class="link">Source</a> <a href="#t:UpdateOption" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:UpdateOption:Show:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Database-MongoDB-Query.html#t:UpdateOption">UpdateOption</a> -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Database-MongoDB-Query.html#t:UpdateOption">UpdateOption</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Database-MongoDB-Query.html#t:UpdateOption">UpdateOption</a>] -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Upserted" class="def">Upserted</a> <a href="src/Database.MongoDB.Query.html#Upserted" class="link">Source</a> <a href="#t:Upserted" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Upserted" class="def">Upserted</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:upsertedIndex" class="def">upsertedIndex</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:upsertedId" class="def">upsertedId</a> :: <a href="../bson-0.3.2.3/Data-Bson.html#t:ObjectId">ObjectId</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:Upserted" class="caption collapser" onclick="toggleSection('i:Upserted')">Instances</p><div id="section.i:Upserted" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Upserted:Show:1" class="instance expander" onclick="toggleSection('i:id:Upserted:Show:1')"></span> <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> <a href="Database-MongoDB-Query.html#t:Upserted">Upserted</a></span> <a href="src/Database.MongoDB.Query.html#line-178" class="link">Source</a> <a href="#t:Upserted" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Upserted:Show:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Database-MongoDB-Query.html#t:Upserted">Upserted</a> -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Database-MongoDB-Query.html#t:Upserted">Upserted</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Database-MongoDB-Query.html#t:Upserted">Upserted</a>] -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><h2 id="g:9">Delete</h2><div class="top"><p class="src"><a id="v:delete" class="def">delete</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m () <a href="src/Database.MongoDB.Query.html#delete" class="link">Source</a> <a href="#v:delete" class="selflink">#</a></p><div class="doc"><p>Delete all documents in selection</p></div></div><div class="top"><p class="src"><a id="v:deleteOne" class="def">deleteOne</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m () <a href="src/Database.MongoDB.Query.html#deleteOne" class="link">Source</a> <a href="#v:deleteOne" class="selflink">#</a></p><div class="doc"><p>Delete first document in selection</p></div></div><div class="top"><p class="src"><a id="v:deleteMany" class="def">deleteMany</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; [(<a href="Database-MongoDB-Query.html#t:Selector">Selector</a>, [<a href="Database-MongoDB-Query.html#t:DeleteOption">DeleteOption</a>])] -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="Database-MongoDB-Query.html#t:WriteResult">WriteResult</a> <a href="src/Database.MongoDB.Query.html#deleteMany" class="link">Source</a> <a href="#v:deleteMany" class="selflink">#</a></p><div class="doc"><p>Bulk delete operation. If one delete fails it will not delete the remaining
 - documents. Current returned value is only a place holder. With mongodb server
 - before 2.6 it will send delete requests one by one. After 2.6 it will use
 - bulk delete feature in mongodb.</p></div></div><div class="top"><p class="src"><a id="v:deleteAll" class="def">deleteAll</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; [(<a href="Database-MongoDB-Query.html#t:Selector">Selector</a>, [<a href="Database-MongoDB-Query.html#t:DeleteOption">DeleteOption</a>])] -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="Database-MongoDB-Query.html#t:WriteResult">WriteResult</a> <a href="src/Database.MongoDB.Query.html#deleteAll" class="link">Source</a> <a href="#v:deleteAll" class="selflink">#</a></p><div class="doc"><p>Bulk delete operation. If one delete fails it will proceed with the
 - remaining documents. Current returned value is only a place holder. With
 - mongodb server before 2.6 it will send delete requests one by one. After 2.6
 - it will use bulk delete feature in mongodb.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:DeleteOption" class="def">DeleteOption</a> <a href="src/Database.MongoDB.Internal.Protocol.html#DeleteOption" class="link">Source</a> <a href="#t:DeleteOption" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:SingleRemove" class="def">SingleRemove</a></td><td class="doc"><p>If set, the database will remove only the first matching document in the collection. Otherwise all matching documents will be removed</p></td></tr></table></div><div class="subs instances"><p id="control.i:DeleteOption" class="caption collapser" onclick="toggleSection('i:DeleteOption')">Instances</p><div id="section.i:DeleteOption" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:DeleteOption:Eq:1" class="instance expander" onclick="toggleSection('i:id:DeleteOption:Eq:1')"></span> <a href="../base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> <a href="Database-MongoDB-Query.html#t:DeleteOption">DeleteOption</a></span> <a href="src/Database.MongoDB.Internal.Protocol.html#line-317" class="link">Source</a> <a href="#t:DeleteOption" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:DeleteOption:Eq:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Database-MongoDB-Query.html#t:DeleteOption">DeleteOption</a> -&gt; <a href="Database-MongoDB-Query.html#t:DeleteOption">DeleteOption</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Database-MongoDB-Query.html#t:DeleteOption">DeleteOption</a> -&gt; <a href="Database-MongoDB-Query.html#t:DeleteOption">DeleteOption</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:DeleteOption:Show:2" class="instance expander" onclick="toggleSection('i:id:DeleteOption:Show:2')"></span> <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> <a href="Database-MongoDB-Query.html#t:DeleteOption">DeleteOption</a></span> <a href="src/Database.MongoDB.Internal.Protocol.html#line-317" class="link">Source</a> <a href="#t:DeleteOption" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:DeleteOption:Show:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Database-MongoDB-Query.html#t:DeleteOption">DeleteOption</a> -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Database-MongoDB-Query.html#t:DeleteOption">DeleteOption</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Database-MongoDB-Query.html#t:DeleteOption">DeleteOption</a>] -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><h1 id="g:10">Read</h1><h2 id="g:11">Query</h2><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Query" class="def">Query</a> <a href="src/Database.MongoDB.Query.html#Query" class="link">Source</a> <a href="#t:Query" class="selflink">#</a></p><div class="doc"><p>Use <code><a href="Database-MongoDB-Query.html#v:select">select</a></code> to create a basic query with defaults, then modify if desired. For example, <code>(select sel col) {limit = 10}</code></p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Query" class="def">Query</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:options" class="def">options</a> :: [<a href="Database-MongoDB-Query.html#t:QueryOption">QueryOption</a>]</dfn><div class="doc"><p>Default = []</p></div></li><li><dfn class="src"><a id="v:selection" class="def">selection</a> :: <a href="Database-MongoDB-Query.html#t:Selection">Selection</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:project" class="def">project</a> :: <a href="Database-MongoDB-Query.html#t:Projector">Projector</a></dfn><div class="doc"><p>[] = all fields. Default = []</p></div></li><li><dfn class="src"><a id="v:skip" class="def">skip</a> :: <a href="../base-4.9.1.0/Data-Word.html#t:Word32">Word32</a></dfn><div class="doc"><p>Number of initial matching documents to skip. Default = 0</p></div></li><li><dfn class="src"><a id="v:limit" class="def">limit</a> :: <a href="Database-MongoDB-Query.html#t:Limit">Limit</a></dfn><div class="doc"><p>Maximum number of documents to return, 0 = no limit. Default = 0</p></div></li><li><dfn class="src"><a id="v:sort" class="def">sort</a> :: <a href="Database-MongoDB-Query.html#t:Order">Order</a></dfn><div class="doc"><p>Sort results by this order, [] = no sort. Default = []</p></div></li><li><dfn class="src"><a id="v:snapshot" class="def">snapshot</a> :: <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></dfn><div class="doc"><p>If true assures no duplicates are returned, or objects missed, which were present at both the start and end of the query's execution (even if the object were updated). If an object is new during the query, or deleted during the query, it may or may not be returned, even with snapshot mode. Note that short query responses (less than 1MB) are always effectively snapshotted. Default = False</p></div></li><li><dfn class="src"><a id="v:batchSize" class="def">batchSize</a> :: <a href="Database-MongoDB-Query.html#t:BatchSize">BatchSize</a></dfn><div class="doc"><p>The number of document to return in each batch response from the server. 0 means use Mongo default. Default = 0</p></div></li><li><dfn class="src"><a id="v:hint" class="def">hint</a> :: <a href="Database-MongoDB-Query.html#t:Order">Order</a></dfn><div class="doc"><p>Force MongoDB to use this index, [] = no hint. Default = []</p></div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:Query" class="caption collapser" onclick="toggleSection('i:Query')">Instances</p><div id="section.i:Query" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Query:Eq:1" class="instance expander" onclick="toggleSection('i:id:Query:Eq:1')"></span> <a href="../base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> <a href="Database-MongoDB-Query.html#t:Query">Query</a></span> <a href="src/Database.MongoDB.Query.html#line-1014" class="link">Source</a> <a href="#t:Query" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Query:Eq:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Database-MongoDB-Query.html#t:Query">Query</a> -&gt; <a href="Database-MongoDB-Query.html#t:Query">Query</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Database-MongoDB-Query.html#t:Query">Query</a> -&gt; <a href="Database-MongoDB-Query.html#t:Query">Query</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Query:Show:2" class="instance expander" onclick="toggleSection('i:id:Query:Show:2')"></span> <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> <a href="Database-MongoDB-Query.html#t:Query">Query</a></span> <a href="src/Database.MongoDB.Query.html#line-1014" class="link">Source</a> <a href="#t:Query" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Query:Show:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Database-MongoDB-Query.html#t:Query">Query</a> -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Database-MongoDB-Query.html#t:Query">Query</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Database-MongoDB-Query.html#t:Query">Query</a>] -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Query:Select:3" class="instance expander" onclick="toggleSection('i:id:Query:Select:3')"></span> <a href="Database-MongoDB-Query.html#t:Select">Select</a> <a href="Database-MongoDB-Query.html#t:Query">Query</a></span> <a href="src/Database.MongoDB.Query.html#line-390" class="link">Source</a> <a href="#t:Query" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Query:Select:3" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:select">select</a> :: <a href="Database-MongoDB-Query.html#t:Selector">Selector</a> -&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; <a href="Database-MongoDB-Query.html#t:Query">Query</a> <a href="src/Database.MongoDB.Query.html#select" class="link">Source</a> <a href="#v:select" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:QueryOption" class="def">QueryOption</a> <a href="src/Database.MongoDB.Internal.Protocol.html#QueryOption" class="link">Source</a> <a href="#t:QueryOption" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TailableCursor" class="def">TailableCursor</a></td><td class="doc"><p>Tailable means cursor is not closed when the last data is retrieved. Rather, the cursor marks the final object's position. You can resume using the cursor later, from where it was located, if more data were received. Like any &quot;latent cursor&quot;, the cursor may become invalid at some point &#8211; for example if the final object it references were deleted. Thus, you should be prepared to requery on CursorNotFound exception.</p></td></tr><tr><td class="src"><a id="v:NoCursorTimeout" class="def">NoCursorTimeout</a></td><td class="doc"><p>The server normally times out idle cursors after 10 minutes to prevent a memory leak in case a client forgets to close a cursor. Set this option to allow a cursor to live forever until it is closed.</p></td></tr><tr><td class="src"><a id="v:AwaitData" class="def">AwaitData</a></td><td class="doc"><p>Use with TailableCursor. If we are at the end of the data, block for a while rather than returning no data. After a timeout period, we do return as normal.
  | Exhaust  -- ^ Stream the data down full blast in multiple &quot;more&quot; packages, on the assumption that the client will fully read all data queried. Faster when you are pulling a lot of data and know you want to pull it all down. Note: the client is not allowed to not read all the data unless it closes the connection.
 Exhaust commented out because not compatible with current <code>Pipeline</code> implementation</p></td></tr><tr><td class="src"><a id="v:Partial" class="def">Partial</a></td><td class="doc"><p>Get partial results from a _mongos_ if some shards are down, instead of throwing an error.</p></td></tr></table></div><div class="subs instances"><p id="control.i:QueryOption" class="caption collapser" onclick="toggleSection('i:QueryOption')">Instances</p><div id="section.i:QueryOption" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:QueryOption:Eq:1" class="instance expander" onclick="toggleSection('i:id:QueryOption:Eq:1')"></span> <a href="../base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> <a href="Database-MongoDB-Query.html#t:QueryOption">QueryOption</a></span> <a href="src/Database.MongoDB.Internal.Protocol.html#line-397" class="link">Source</a> <a href="#t:QueryOption" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:QueryOption:Eq:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Database-MongoDB-Query.html#t:QueryOption">QueryOption</a> -&gt; <a href="Database-MongoDB-Query.html#t:QueryOption">QueryOption</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Database-MongoDB-Query.html#t:QueryOption">QueryOption</a> -&gt; <a href="Database-MongoDB-Query.html#t:QueryOption">QueryOption</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:QueryOption:Show:2" class="instance expander" onclick="toggleSection('i:id:QueryOption:Show:2')"></span> <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> <a href="Database-MongoDB-Query.html#t:QueryOption">QueryOption</a></span> <a href="src/Database.MongoDB.Internal.Protocol.html#line-397" class="link">Source</a> <a href="#t:QueryOption" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:QueryOption:Show:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Database-MongoDB-Query.html#t:QueryOption">QueryOption</a> -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Database-MongoDB-Query.html#t:QueryOption">QueryOption</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Database-MongoDB-Query.html#t:QueryOption">QueryOption</a>] -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Projector" class="def">Projector</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> <a href="src/Database.MongoDB.Query.html#Projector" class="link">Source</a> <a href="#t:Projector" class="selflink">#</a></p><div class="doc"><p>Fields to return, analogous to the select clause in SQL. <code>[]</code> means return whole document (analogous to * in SQL). <code>[&quot;x&quot; =: 1, &quot;y&quot; =: 1]</code> means return only <code>x</code> and <code>y</code> fields of each document. <code>[&quot;x&quot; =: 0]</code> means return all fields except <code>x</code>.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Limit" class="def">Limit</a> = <a href="../base-4.9.1.0/Data-Word.html#t:Word32">Word32</a> <a href="src/Database.MongoDB.Query.html#Limit" class="link">Source</a> <a href="#t:Limit" class="selflink">#</a></p><div class="doc"><p>Maximum number of documents to return, i.e. cursor will close after iterating over this number of documents. 0 means no limit.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Order" class="def">Order</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> <a href="src/Database.MongoDB.Query.html#Order" class="link">Source</a> <a href="#t:Order" class="selflink">#</a></p><div class="doc"><p>Fields to sort by. Each one is associated with 1 or -1. Eg. <code>[&quot;x&quot; =: 1, &quot;y&quot; =: -1]</code> means sort by <code>x</code> ascending then <code>y</code> descending</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:BatchSize" class="def">BatchSize</a> = <a href="../base-4.9.1.0/Data-Word.html#t:Word32">Word32</a> <a href="src/Database.MongoDB.Query.html#BatchSize" class="link">Source</a> <a href="#t:BatchSize" class="selflink">#</a></p><div class="doc"><p>The number of document to return in each batch response from the server. 0 means use Mongo default.</p></div></div><div class="top"><p class="src"><a id="v:explain" class="def">explain</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Query">Query</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> <a href="src/Database.MongoDB.Query.html#explain" class="link">Source</a> <a href="#v:explain" class="selflink">#</a></p><div class="doc"><p>Return performance stats of query execution</p></div></div><div class="top"><p class="src"><a id="v:find" class="def">find</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Query">Query</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="Database-MongoDB-Query.html#t:Cursor">Cursor</a> <a href="src/Database.MongoDB.Query.html#find" class="link">Source</a> <a href="#v:find" class="selflink">#</a></p><div class="doc"><p>Fetch documents satisfying query</p></div></div><div class="top"><p class="src"><a id="v:findOne" class="def">findOne</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Query">Query</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m (<a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>) <a href="src/Database.MongoDB.Query.html#findOne" class="link">Source</a> <a href="#v:findOne" class="selflink">#</a></p><div class="doc"><p>Fetch first document satisfying query or Nothing if none satisfy it</p></div></div><div class="top"><p class="src"><a id="v:fetch" class="def">fetch</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Query">Query</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> <a href="src/Database.MongoDB.Query.html#fetch" class="link">Source</a> <a href="#v:fetch" class="selflink">#</a></p><div class="doc"><p>Same as <code><a href="Database-MongoDB-Query.html#v:findOne">findOne</a></code> except throw <code><a href="Database-MongoDB-Query.html#v:DocNotFound">DocNotFound</a></code> if none match</p></div></div><div class="top"><p class="src"><a id="v:findAndModify" class="def">findAndModify</a> <a href="src/Database.MongoDB.Query.html#findAndModify" class="link">Source</a> <a href="#v:findAndModify" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Database-MongoDB-Query.html#t:Query">Query</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a></td><td class="doc"><p>updates</p></td></tr><tr><td class="src">-&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m (<a href="../base-4.9.1.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>runs the findAndModify command as an update without an upsert and new set to true.
 Returns a single updated document (new option is set to true).</p><p>see <code><a href="Database-MongoDB-Query.html#v:findAndModifyOpts">findAndModifyOpts</a></code> if you want to use findAndModify in a differnt way</p></div></div><div class="top"><p class="src"><a id="v:findAndModifyOpts" class="def">findAndModifyOpts</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Query">Query</a> -&gt; <a href="Database-MongoDB-Query.html#t:FindAndModifyOpts">FindAndModifyOpts</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m (<a href="../base-4.9.1.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> (<a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>)) <a href="src/Database.MongoDB.Query.html#findAndModifyOpts" class="link">Source</a> <a href="#v:findAndModifyOpts" class="selflink">#</a></p><div class="doc"><p>runs the findAndModify command,
 allows more options than <code><a href="Database-MongoDB-Query.html#v:findAndModify">findAndModify</a></code></p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:FindAndModifyOpts" class="def">FindAndModifyOpts</a> <a href="src/Database.MongoDB.Query.html#FindAndModifyOpts" class="link">Source</a> <a href="#t:FindAndModifyOpts" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:FamRemove" class="def">FamRemove</a> <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:FamUpdate" class="def">FamUpdate</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:famUpdate" class="def">famUpdate</a> :: <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:famNew" class="def">famNew</a> :: <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:famUpsert" class="def">famUpsert</a> :: <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:FindAndModifyOpts" class="caption collapser" onclick="toggleSection('i:FindAndModifyOpts')">Instances</p><div id="section.i:FindAndModifyOpts" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:FindAndModifyOpts:Show:1" class="instance expander" onclick="toggleSection('i:id:FindAndModifyOpts:Show:1')"></span> <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> <a href="Database-MongoDB-Query.html#t:FindAndModifyOpts">FindAndModifyOpts</a></span> <a href="src/Database.MongoDB.Query.html#line-1060" class="link">Source</a> <a href="#t:FindAndModifyOpts" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:FindAndModifyOpts:Show:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Database-MongoDB-Query.html#t:FindAndModifyOpts">FindAndModifyOpts</a> -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Database-MongoDB-Query.html#t:FindAndModifyOpts">FindAndModifyOpts</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Database-MongoDB-Query.html#t:FindAndModifyOpts">FindAndModifyOpts</a>] -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><a id="v:defFamUpdateOpts" class="def">defFamUpdateOpts</a> :: <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> -&gt; <a href="Database-MongoDB-Query.html#t:FindAndModifyOpts">FindAndModifyOpts</a> <a href="src/Database.MongoDB.Query.html#defFamUpdateOpts" class="link">Source</a> <a href="#v:defFamUpdateOpts" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:count" class="def">count</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Query">Query</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> <a href="src/Database.MongoDB.Query.html#count" class="link">Source</a> <a href="#v:count" class="selflink">#</a></p><div class="doc"><p>Fetch number of documents satisfying query (including effect of skip and/or limit if present)</p></div></div><div class="top"><p class="src"><a id="v:distinct" class="def">distinct</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Label">Label</a> -&gt; <a href="Database-MongoDB-Query.html#t:Selection">Selection</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="../bson-0.3.2.3/Data-Bson.html#t:Value">Value</a>] <a href="src/Database.MongoDB.Query.html#distinct" class="link">Source</a> <a href="#v:distinct" class="selflink">#</a></p><div class="doc"><p>Fetch distinct values of field in selected documents</p></div></div><h3 id="g:12">Cursor</h3><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Cursor" class="def">Cursor</a> <a href="src/Database.MongoDB.Query.html#Cursor" class="link">Source</a> <a href="#t:Cursor" class="selflink">#</a></p><div class="doc"><p>Iterator over results of a query. Use <code><a href="Database-MongoDB-Query.html#v:next">next</a></code> to iterate or <code><a href="Database-MongoDB-Query.html#v:rest">rest</a></code> to get all results. A cursor is closed when it is explicitly closed, all results have been read from it, garbage collected, or not used for over 10 minutes (unless <code><a href="Database-MongoDB-Query.html#v:NoCursorTimeout">NoCursorTimeout</a></code> option was specified in <code><a href="Database-MongoDB-Query.html#t:Query">Query</a></code>). Reading from a closed cursor raises a <code><a href="Database-MongoDB-Query.html#v:CursorNotFoundFailure">CursorNotFoundFailure</a></code>. Note, a cursor is not closed when the pipe is closed, so you can open another pipe to the same server and continue using the cursor.</p></div></div><div class="top"><p class="src"><a id="v:nextBatch" class="def">nextBatch</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Cursor">Cursor</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>] <a href="src/Database.MongoDB.Query.html#nextBatch" class="link">Source</a> <a href="#v:nextBatch" class="selflink">#</a></p><div class="doc"><p>Return next batch of documents in query result, which will be empty if finished.</p></div></div><div class="top"><p class="src"><a id="v:next" class="def">next</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Cursor">Cursor</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m (<a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>) <a href="src/Database.MongoDB.Query.html#next" class="link">Source</a> <a href="#v:next" class="selflink">#</a></p><div class="doc"><p>Return next document in query result, or Nothing if finished.</p></div></div><div class="top"><p class="src"><a id="v:nextN" class="def">nextN</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Database-MongoDB-Query.html#t:Cursor">Cursor</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>] <a href="src/Database.MongoDB.Query.html#nextN" class="link">Source</a> <a href="#v:nextN" class="selflink">#</a></p><div class="doc"><p>Return next N documents or less if end is reached</p></div></div><div class="top"><p class="src"><a id="v:rest" class="def">rest</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Cursor">Cursor</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>] <a href="src/Database.MongoDB.Query.html#rest" class="link">Source</a> <a href="#v:rest" class="selflink">#</a></p><div class="doc"><p>Return remaining documents in query result</p></div></div><div class="top"><p class="src"><a id="v:closeCursor" class="def">closeCursor</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Cursor">Cursor</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m () <a href="src/Database.MongoDB.Query.html#closeCursor" class="link">Source</a> <a href="#v:closeCursor" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:isCursorClosed" class="def">isCursorClosed</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Cursor">Cursor</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Database.MongoDB.Query.html#isCursorClosed" class="link">Source</a> <a href="#v:isCursorClosed" class="selflink">#</a></p></div><h2 id="g:13">Aggregate</h2><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Pipeline" class="def">Pipeline</a> = [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>] <a href="src/Database.MongoDB.Query.html#Pipeline" class="link">Source</a> <a href="#t:Pipeline" class="selflink">#</a></p><div class="doc"><p>The Aggregate Pipeline</p></div></div><div class="top"><p class="src"><a id="v:aggregate" class="def">aggregate</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; <a href="Database-MongoDB-Query.html#t:Pipeline">Pipeline</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>] <a href="src/Database.MongoDB.Query.html#aggregate" class="link">Source</a> <a href="#v:aggregate" class="selflink">#</a></p><div class="doc"><p>Runs an aggregate and unpacks the result. See <a href="http://docs.mongodb.org/manual/core/aggregation/">http://docs.mongodb.org/manual/core/aggregation/</a> for details.</p></div></div><h2 id="g:14">Group</h2><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Group" class="def">Group</a> <a href="src/Database.MongoDB.Query.html#Group" class="link">Source</a> <a href="#t:Group" class="selflink">#</a></p><div class="doc"><p>Groups documents in collection by key then reduces (aggregates) each group</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Group" class="def">Group</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:gColl" class="def">gColl</a> :: <a href="Database-MongoDB-Query.html#t:Collection">Collection</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:gKey" class="def">gKey</a> :: <a href="Database-MongoDB-Query.html#t:GroupKey">GroupKey</a></dfn><div class="doc"><p>Fields to group by</p></div></li><li><dfn class="src"><a id="v:gReduce" class="def">gReduce</a> :: <a href="../bson-0.3.2.3/Data-Bson.html#t:Javascript">Javascript</a></dfn><div class="doc"><p><code>(doc, agg) -&gt; ()</code>. The reduce function reduces (aggregates) the objects iterated. Typical operations of a reduce function include summing and counting. It takes two arguments, the current document being iterated over and the aggregation value, and updates the aggregate value.</p></div></li><li><dfn class="src"><a id="v:gInitial" class="def">gInitial</a> :: <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a></dfn><div class="doc"><p><code>agg</code>. Initial aggregation value supplied to reduce</p></div></li><li><dfn class="src"><a id="v:gCond" class="def">gCond</a> :: <a href="Database-MongoDB-Query.html#t:Selector">Selector</a></dfn><div class="doc"><p>Condition that must be true for a row to be considered. [] means always true.</p></div></li><li><dfn class="src"><a id="v:gFinalize" class="def">gFinalize</a> :: <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="../bson-0.3.2.3/Data-Bson.html#t:Javascript">Javascript</a></dfn><div class="doc"><p><code>agg -&gt; () | result</code>. An optional function to be run on each item in the result set just before the item is returned. Can either modify the item (e.g., add an average field given a count and a total) or return a replacement object (returning a new object with just _id and average fields).</p></div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:Group" class="caption collapser" onclick="toggleSection('i:Group')">Instances</p><div id="section.i:Group" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Group:Eq:1" class="instance expander" onclick="toggleSection('i:id:Group:Eq:1')"></span> <a href="../base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> <a href="Database-MongoDB-Query.html#t:Group">Group</a></span> <a href="src/Database.MongoDB.Query.html#line-1327" class="link">Source</a> <a href="#t:Group" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Group:Eq:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Database-MongoDB-Query.html#t:Group">Group</a> -&gt; <a href="Database-MongoDB-Query.html#t:Group">Group</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Database-MongoDB-Query.html#t:Group">Group</a> -&gt; <a href="Database-MongoDB-Query.html#t:Group">Group</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Group:Show:2" class="instance expander" onclick="toggleSection('i:id:Group:Show:2')"></span> <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> <a href="Database-MongoDB-Query.html#t:Group">Group</a></span> <a href="src/Database.MongoDB.Query.html#line-1327" class="link">Source</a> <a href="#t:Group" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Group:Show:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Database-MongoDB-Query.html#t:Group">Group</a> -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Database-MongoDB-Query.html#t:Group">Group</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Database-MongoDB-Query.html#t:Group">Group</a>] -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:GroupKey" class="def">GroupKey</a> <a href="src/Database.MongoDB.Query.html#GroupKey" class="link">Source</a> <a href="#t:GroupKey" class="selflink">#</a></p><div class="doc"><p>Fields to group by, or function (<code>doc -&gt; key</code>) returning a &quot;key object&quot; to be used as the grouping key. Use KeyF instead of Key to specify a key that is not an existing member of the object (or, to access embedded members).</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Key" class="def">Key</a> [<a href="../bson-0.3.2.3/Data-Bson.html#t:Label">Label</a>]</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:KeyF" class="def">KeyF</a> <a href="../bson-0.3.2.3/Data-Bson.html#t:Javascript">Javascript</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:GroupKey" class="caption collapser" onclick="toggleSection('i:GroupKey')">Instances</p><div id="section.i:GroupKey" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:GroupKey:Eq:1" class="instance expander" onclick="toggleSection('i:id:GroupKey:Eq:1')"></span> <a href="../base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> <a href="Database-MongoDB-Query.html#t:GroupKey">GroupKey</a></span> <a href="src/Database.MongoDB.Query.html#line-1329" class="link">Source</a> <a href="#t:GroupKey" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:GroupKey:Eq:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Database-MongoDB-Query.html#t:GroupKey">GroupKey</a> -&gt; <a href="Database-MongoDB-Query.html#t:GroupKey">GroupKey</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Database-MongoDB-Query.html#t:GroupKey">GroupKey</a> -&gt; <a href="Database-MongoDB-Query.html#t:GroupKey">GroupKey</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:GroupKey:Show:2" class="instance expander" onclick="toggleSection('i:id:GroupKey:Show:2')"></span> <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> <a href="Database-MongoDB-Query.html#t:GroupKey">GroupKey</a></span> <a href="src/Database.MongoDB.Query.html#line-1329" class="link">Source</a> <a href="#t:GroupKey" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:GroupKey:Show:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Database-MongoDB-Query.html#t:GroupKey">GroupKey</a> -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Database-MongoDB-Query.html#t:GroupKey">GroupKey</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Database-MongoDB-Query.html#t:GroupKey">GroupKey</a>] -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><a id="v:group" class="def">group</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Group">Group</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m [<a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a>] <a href="src/Database.MongoDB.Query.html#group" class="link">Source</a> <a href="#v:group" class="selflink">#</a></p><div class="doc"><p>Execute group query and return resulting aggregate value for each distinct key</p></div></div><h2 id="g:15">MapReduce</h2><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:MapReduce" class="def">MapReduce</a> <a href="src/Database.MongoDB.Query.html#MapReduce" class="link">Source</a> <a href="#t:MapReduce" class="selflink">#</a></p><div class="doc"><p>Maps every document in collection to a list of (key, value) pairs, then for each unique key reduces all its associated values to a single result. There are additional parameters that may be set to tweak this basic operation.
 This implements the latest version of map-reduce that requires MongoDB 1.7.4 or greater. To map-reduce against an older server use runCommand directly as described in <a href="http://www.mongodb.org/display/DOCS/MapReduce">http://www.mongodb.org/display/DOCS/MapReduce</a>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:MapReduce" class="def">MapReduce</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:rColl" class="def">rColl</a> :: <a href="Database-MongoDB-Query.html#t:Collection">Collection</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:rMap" class="def">rMap</a> :: <a href="Database-MongoDB-Query.html#t:MapFun">MapFun</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:rReduce" class="def">rReduce</a> :: <a href="Database-MongoDB-Query.html#t:ReduceFun">ReduceFun</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:rSelect" class="def">rSelect</a> :: <a href="Database-MongoDB-Query.html#t:Selector">Selector</a></dfn><div class="doc"><p>Operate on only those documents selected. Default is [] meaning all documents.</p></div></li><li><dfn class="src"><a id="v:rSort" class="def">rSort</a> :: <a href="Database-MongoDB-Query.html#t:Order">Order</a></dfn><div class="doc"><p>Default is [] meaning no sort</p></div></li><li><dfn class="src"><a id="v:rLimit" class="def">rLimit</a> :: <a href="Database-MongoDB-Query.html#t:Limit">Limit</a></dfn><div class="doc"><p>Default is 0 meaning no limit</p></div></li><li><dfn class="src"><a id="v:rOut" class="def">rOut</a> :: <a href="Database-MongoDB-Query.html#t:MROut">MROut</a></dfn><div class="doc"><p>Output to a collection with a certain merge policy. Default is no collection (<code><a href="Database-MongoDB-Query.html#v:Inline">Inline</a></code>). Note, you don't want this default if your result set is large.</p></div></li><li><dfn class="src"><a id="v:rFinalize" class="def">rFinalize</a> :: <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Database-MongoDB-Query.html#t:FinalizeFun">FinalizeFun</a></dfn><div class="doc"><p>Function to apply to all the results when finished. Default is Nothing.</p></div></li><li><dfn class="src"><a id="v:rScope" class="def">rScope</a> :: <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a></dfn><div class="doc"><p>Variables (environment) that can be accessed from map<em>reduce</em>finalize. Default is [].</p></div></li><li><dfn class="src"><a id="v:rVerbose" class="def">rVerbose</a> :: <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></dfn><div class="doc"><p>Provide statistics on job execution time. Default is False.</p></div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:MapReduce" class="caption collapser" onclick="toggleSection('i:MapReduce')">Instances</p><div id="section.i:MapReduce" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:MapReduce:Eq:1" class="instance expander" onclick="toggleSection('i:id:MapReduce:Eq:1')"></span> <a href="../base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> <a href="Database-MongoDB-Query.html#t:MapReduce">MapReduce</a></span> <a href="src/Database.MongoDB.Query.html#line-1361" class="link">Source</a> <a href="#t:MapReduce" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:MapReduce:Eq:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Database-MongoDB-Query.html#t:MapReduce">MapReduce</a> -&gt; <a href="Database-MongoDB-Query.html#t:MapReduce">MapReduce</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Database-MongoDB-Query.html#t:MapReduce">MapReduce</a> -&gt; <a href="Database-MongoDB-Query.html#t:MapReduce">MapReduce</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:MapReduce:Show:2" class="instance expander" onclick="toggleSection('i:id:MapReduce:Show:2')"></span> <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> <a href="Database-MongoDB-Query.html#t:MapReduce">MapReduce</a></span> <a href="src/Database.MongoDB.Query.html#line-1361" class="link">Source</a> <a href="#t:MapReduce" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:MapReduce:Show:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Database-MongoDB-Query.html#t:MapReduce">MapReduce</a> -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Database-MongoDB-Query.html#t:MapReduce">MapReduce</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Database-MongoDB-Query.html#t:MapReduce">MapReduce</a>] -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:MapFun" class="def">MapFun</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Javascript">Javascript</a> <a href="src/Database.MongoDB.Query.html#MapFun" class="link">Source</a> <a href="#t:MapFun" class="selflink">#</a></p><div class="doc"><p><code>() -&gt; void</code>. The map function references the variable <code>this</code> to inspect the current object under consideration. The function must call <code>emit(key,value)</code> at least once, but may be invoked any number of times, as may be appropriate.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:ReduceFun" class="def">ReduceFun</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Javascript">Javascript</a> <a href="src/Database.MongoDB.Query.html#ReduceFun" class="link">Source</a> <a href="#t:ReduceFun" class="selflink">#</a></p><div class="doc"><p><code>(key, [value]) -&gt; value</code>. The reduce function receives a key and an array of values and returns an aggregate result value. The MapReduce engine may invoke reduce functions iteratively; thus, these functions must be idempotent.  That is, the following must hold for your reduce function: <code>reduce(k, [reduce(k,vs)]) == reduce(k,vs)</code>. If you need to perform an operation only once, use a finalize function. The output of emit (the 2nd param) and reduce should be the same format to make iterative reduce possible.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FinalizeFun" class="def">FinalizeFun</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Javascript">Javascript</a> <a href="src/Database.MongoDB.Query.html#FinalizeFun" class="link">Source</a> <a href="#t:FinalizeFun" class="selflink">#</a></p><div class="doc"><p><code>(key, value) -&gt; final_value</code>. A finalize function may be run after reduction.  Such a function is optional and is not necessary for many map/reduce cases.  The finalize function takes a key and a value, and returns a finalized value.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:MROut" class="def">MROut</a> <a href="src/Database.MongoDB.Query.html#MROut" class="link">Source</a> <a href="#t:MROut" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Inline" class="def">Inline</a></td><td class="doc"><p>Return results directly instead of writing them to an output collection. Results must fit within 16MB limit of a single document</p></td></tr><tr><td class="src"><a id="v:Output" class="def">Output</a> <a href="Database-MongoDB-Query.html#t:MRMerge">MRMerge</a> <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> (<a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Database-MongoDB-Query.html#t:Database">Database</a>)</td><td class="doc"><p>Write results to given collection, in other database if specified. Follow merge policy when entry already exists</p></td></tr></table></div><div class="subs instances"><p id="control.i:MROut" class="caption collapser" onclick="toggleSection('i:MROut')">Instances</p><div id="section.i:MROut" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:MROut:Eq:1" class="instance expander" onclick="toggleSection('i:id:MROut:Eq:1')"></span> <a href="../base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> <a href="Database-MongoDB-Query.html#t:MROut">MROut</a></span> <a href="src/Database.MongoDB.Query.html#line-1375" class="link">Source</a> <a href="#t:MROut" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:MROut:Eq:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Database-MongoDB-Query.html#t:MROut">MROut</a> -&gt; <a href="Database-MongoDB-Query.html#t:MROut">MROut</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Database-MongoDB-Query.html#t:MROut">MROut</a> -&gt; <a href="Database-MongoDB-Query.html#t:MROut">MROut</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:MROut:Show:2" class="instance expander" onclick="toggleSection('i:id:MROut:Show:2')"></span> <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> <a href="Database-MongoDB-Query.html#t:MROut">MROut</a></span> <a href="src/Database.MongoDB.Query.html#line-1375" class="link">Source</a> <a href="#t:MROut" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:MROut:Show:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Database-MongoDB-Query.html#t:MROut">MROut</a> -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Database-MongoDB-Query.html#t:MROut">MROut</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Database-MongoDB-Query.html#t:MROut">MROut</a>] -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:MRMerge" class="def">MRMerge</a> <a href="src/Database.MongoDB.Query.html#MRMerge" class="link">Source</a> <a href="#t:MRMerge" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Replace" class="def">Replace</a></td><td class="doc"><p>Clear all old data and replace it with new data</p></td></tr><tr><td class="src"><a id="v:Merge" class="def">Merge</a></td><td class="doc"><p>Leave old data but overwrite entries with the same key with new data</p></td></tr><tr><td class="src"><a id="v:Reduce" class="def">Reduce</a></td><td class="doc"><p>Leave old data but combine entries with the same key via MR's reduce function</p></td></tr></table></div><div class="subs instances"><p id="control.i:MRMerge" class="caption collapser" onclick="toggleSection('i:MRMerge')">Instances</p><div id="section.i:MRMerge" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:MRMerge:Eq:1" class="instance expander" onclick="toggleSection('i:id:MRMerge:Eq:1')"></span> <a href="../base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> <a href="Database-MongoDB-Query.html#t:MRMerge">MRMerge</a></span> <a href="src/Database.MongoDB.Query.html#line-1381" class="link">Source</a> <a href="#t:MRMerge" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:MRMerge:Eq:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Database-MongoDB-Query.html#t:MRMerge">MRMerge</a> -&gt; <a href="Database-MongoDB-Query.html#t:MRMerge">MRMerge</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Database-MongoDB-Query.html#t:MRMerge">MRMerge</a> -&gt; <a href="Database-MongoDB-Query.html#t:MRMerge">MRMerge</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:MRMerge:Show:2" class="instance expander" onclick="toggleSection('i:id:MRMerge:Show:2')"></span> <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> <a href="Database-MongoDB-Query.html#t:MRMerge">MRMerge</a></span> <a href="src/Database.MongoDB.Query.html#line-1381" class="link">Source</a> <a href="#t:MRMerge" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:MRMerge:Show:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Database-MongoDB-Query.html#t:MRMerge">MRMerge</a> -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Database-MongoDB-Query.html#t:MRMerge">MRMerge</a> -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Database-MongoDB-Query.html#t:MRMerge">MRMerge</a>] -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:MRResult" class="def">MRResult</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> <a href="src/Database.MongoDB.Query.html#MRResult" class="link">Source</a> <a href="#t:MRResult" class="selflink">#</a></p><div class="doc"><p>Result of running a MapReduce has some stats besides the output. See <a href="http://www.mongodb.org/display/DOCS/MapReduce#MapReduce-Resultobject">http://www.mongodb.org/display/DOCS/MapReduce#MapReduce-Resultobject</a></p></div></div><div class="top"><p class="src"><a id="v:mapReduce" class="def">mapReduce</a> :: <a href="Database-MongoDB-Query.html#t:Collection">Collection</a> -&gt; <a href="Database-MongoDB-Query.html#t:MapFun">MapFun</a> -&gt; <a href="Database-MongoDB-Query.html#t:ReduceFun">ReduceFun</a> -&gt; <a href="Database-MongoDB-Query.html#t:MapReduce">MapReduce</a> <a href="src/Database.MongoDB.Query.html#mapReduce" class="link">Source</a> <a href="#v:mapReduce" class="selflink">#</a></p><div class="doc"><p>MapReduce on collection with given map and reduce functions. Remaining attributes are set to their defaults, which are stated in their comments.</p></div></div><div class="top"><p class="src"><a id="v:runMR" class="def">runMR</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:MapReduce">MapReduce</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="Database-MongoDB-Query.html#t:Cursor">Cursor</a> <a href="src/Database.MongoDB.Query.html#runMR" class="link">Source</a> <a href="#v:runMR" class="selflink">#</a></p><div class="doc"><p>Run MapReduce and return cursor of results. Error if map/reduce fails (because of bad Javascript)</p></div></div><div class="top"><p class="src"><a id="v:runMR-39-" class="def">runMR'</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:MapReduce">MapReduce</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="Database-MongoDB-Query.html#t:MRResult">MRResult</a> <a href="src/Database.MongoDB.Query.html#runMR%27" class="link">Source</a> <a href="#v:runMR-39-" class="selflink">#</a></p><div class="doc"><p>Run MapReduce and return a MR result document containing stats and the results if Inlined. Error if the map/reduce failed (because of bad Javascript).</p></div></div><h1 id="g:16">Command</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Command" class="def">Command</a> = <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> <a href="src/Database.MongoDB.Query.html#Command" class="link">Source</a> <a href="#t:Command" class="selflink">#</a></p><div class="doc"><p>A command is a special query or action against the database. See <a href="http://www.mongodb.org/display/DOCS/Commands">http://www.mongodb.org/display/DOCS/Commands</a> for details.</p></div></div><div class="top"><p class="src"><a id="v:runCommand" class="def">runCommand</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Command">Command</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> <a href="src/Database.MongoDB.Query.html#runCommand" class="link">Source</a> <a href="#v:runCommand" class="selflink">#</a></p><div class="doc"><p>Run command against the database and return its result</p></div></div><div class="top"><p class="src"><a id="v:runCommand1" class="def">runCommand1</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="../text-1.2.2.2/Data-Text.html#t:Text">Text</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="../bson-0.3.2.3/Data-Bson.html#t:Document">Document</a> <a href="src/Database.MongoDB.Query.html#runCommand1" class="link">Source</a> <a href="#v:runCommand1" class="selflink">#</a></p><div class="doc"><pre>runCommand1 foo = runCommand [foo =: 1]</pre></div></div><div class="top"><p class="src"><a id="v:eval" class="def">eval</a> :: (<a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m, <a href="../bson-0.3.2.3/Data-Bson.html#t:Val">Val</a> v) =&gt; <a href="../bson-0.3.2.3/Data-Bson.html#t:Javascript">Javascript</a> -&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m v <a href="src/Database.MongoDB.Query.html#eval" class="link">Source</a> <a href="#v:eval" class="selflink">#</a></p><div class="doc"><p>Run code on server</p></div></div><div class="top"><p class="src"><a id="v:retrieveServerData" class="def">retrieveServerData</a> :: <a href="../base-4.9.1.0/Control-Monad-IO-Class.html#t:MonadIO">MonadIO</a> m =&gt; <a href="Database-MongoDB-Query.html#t:Action">Action</a> m <a href="Database-MongoDB-Query.html#t:ServerData">ServerData</a> <a href="src/Database.MongoDB.Query.html#retrieveServerData" class="link">Source</a> <a href="#v:retrieveServerData" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ServerData" class="def">ServerData</a> <a href="src/Database.MongoDB.Internal.Protocol.html#ServerData" class="link">Source</a> <a href="#t:ServerData" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:ServerData" class="def">ServerData</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:isMaster" class="def">isMaster</a> :: <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:minWireVersion" class="def">minWireVersion</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:maxWireVersion" class="def">maxWireVersion</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:maxMessageSizeBytes" class="def">maxMessageSizeBytes</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:maxBsonObjectSize" class="def">maxBsonObjectSize</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:maxWriteBatchSize" class="def">maxWriteBatchSize</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.3</p></div></body></html>